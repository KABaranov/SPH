# viscosity

В СПH-формулировках вязкость входит в уравнение движения как дополнительная «стягивающая» сила, препятствующая резким относительным смещениям между соседними частицами. Всего обычно различают два «типа» вязкостных сил:

---

## 1. Физическая (ламинарная) вязкость

Для простой ньютоновской жидкости напряжение пропорционально градиенту скоростей. В сплошном представлении в уравнении Навье–Стокса это терм `μ∇²v`. В SPH его дискретизируют через аппроксимацию второй производной (см. § 2.3 выше)

$$
\mathbf{a}_i^{(\nu)} = \sum_j m_j\frac{\mu_i+\mu_j}{\rho_i\rho_j}(v_j - v_i)\,\frac{\mathbf{r}_{ij}\cdot\nabla_iW_{ij}}{|\mathbf{r}_{ij}|^2}\,,
$$

где $\mu$ — динамическая вязкость, $v_j-v_i$ — относительная скорость, и на выходе получается ускорение, направленное так, чтобы «размазывать» неоднородности потока и поддерживать плавность поля скоростей.

---

## 2. Искусственная вязкость

В классических SPH-кодах (Monaghan 1992) добавляют специальный член $\Pi_{ij}$ для стабилизации расчёта вблизи сильных сжатий и ударных волн:

$$
\Pi_{ij} = 
\begin{cases}
\displaystyle
\frac{-\alpha c_\text{avg}\,\mu_{ij} + \beta\,\mu_{ij}^2}{\rho_\text{avg}}\,,& (v_{ij}\cdot r_{ij})<0,\\
0,&\text{иначе,}
\end{cases}
$$

где

$$
\mu_{ij} = \frac{h (v_i-v_j)\cdot(r_i-r_j)}{|\mathbf{r}_i-\mathbf{r}_j|^2+\varepsilon h^2}\,,
$$

$\alpha,\beta\sim O(1)$ — подстройные коэффициенты (обычно $\alpha\approx1$, $\beta\approx2$), $c_\text{avg}$ — средняя звуковая скорость, $\rho_\text{avg}$ — средняя плотность.
Этот член даёт дополнительное трение только когда частицы «сближаются» ($v_{ij}\cdot r_{ij}<0$), что моделирует физическое диссипативное разупорядочивание в ударных фронтах и предотвращает неустойчивый «раскол» частиц.

---

### Кратко о сравнении

* **Ламинарная вязкость** нужна для реальных течений, где диссипация ∝ ∇²v, и хорошо подходит для умеренных скоростей и реологических моделей.
* **Искусственная вязкость** не физически «правильна» в общем смысле, но критически важна для численной устойчивости SPH при описании сильных сжимающих течений и ударов.

Обе они могут сочетаться: реальную вязкость используют для «правильного» затухания вихрей, а искусственную — там, где чисто физическая модель в SPH-дискретизации подводит из-за разреженной аппроксимации ядрами.
